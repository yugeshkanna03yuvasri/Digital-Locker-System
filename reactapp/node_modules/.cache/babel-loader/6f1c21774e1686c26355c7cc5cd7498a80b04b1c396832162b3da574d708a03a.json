{"ast":null,"code":"import React from\"react\";import{BrowserRouter as Router,Routes,Route,Navigate}from\"react-router-dom\";import{AuthProvider,useAuth}from\"./contexts/AuthContext\";import Navbar from\"./components/Navbar\";import Home from\"./components/Home\";import UserDashboard from\"./components/UserDashboard\";import AdminDashboard from\"./components/AdminDashboard\";import LoginForm from\"./components/LoginForm\";import RegisterForm from\"./components/RegisterForm\";import DocumentViewer from\"./components/DocumentViewer\";import UserFileDashboard from\"./components/UserFileDashboard\";// Protected Route Component\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ProtectedRoute=_ref=>{var _user$role;let{children,adminOnly=false}=_ref;const{isAuthenticated,user,loading}=useAuth();if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center min-h-screen\",children:\"Loading...\"});}if(!isAuthenticated){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\"});}// Normalize the role to handle ROLE_ADMIN, Admin, etc.\nconst normalizedRole=(user===null||user===void 0?void 0:(_user$role=user.role)===null||_user$role===void 0?void 0:_user$role.toUpperCase())||\"\";if(adminOnly&&!normalizedRole.includes(\"ADMIN\")){return/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"});}return children;};// Public Route Component (redirect if already logged in)\nconst PublicRoute=_ref2=>{let{children}=_ref2;const{isAuthenticated,loading}=useAuth();if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center min-h-screen\",children:\"Loading...\"});}if(isAuthenticated){return/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"});}return children;};// Dashboard Redirect Component\nconst DashboardRedirect=()=>{const{user,loading}=useAuth();if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center min-h-screen\",children:\"Loading...\"});}if(!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/login\",replace:true});}// Debug logging\nconsole.log('üîç DashboardRedirect - Full user object:',user);console.log('üîç DashboardRedirect - user.role:',user.role);console.log('üîç DashboardRedirect - user.roles:',user.roles);// Handle both cases:\n// Case 1: user.role = \"ROLE_ADMIN\" or \"ADMIN\"\n// Case 2: user.roles = [\"ROLE_ADMIN\", \"ROLE_USER\"]\nlet roles=[];if(Array.isArray(user.roles)){roles=user.roles.map(r=>r.toUpperCase());}else if(user.role){roles=[user.role.toUpperCase()];}console.log('üîç DashboardRedirect - processed roles:',roles);// Check if user has ADMIN in any of their roles\nconst isAdmin=roles.some(r=>r.includes(\"ADMIN\"));console.log('üîç DashboardRedirect - isAdmin:',isAdmin);if(isAdmin){console.log('‚úÖ Redirecting to admin dashboard');return/*#__PURE__*/_jsx(Navigate,{to:\"/admin-dashboard\",replace:true});}else{console.log('‚úÖ Redirecting to file dashboard');return/*#__PURE__*/_jsx(Navigate,{to:\"/file-dashboard\",replace:true});}};function AppContent(){const{isAuthenticated}=useAuth();return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gray-50\",children:[/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsx(\"main\",{className:\"p-6 mt-20\",children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:/*#__PURE__*/_jsx(Home,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:/*#__PURE__*/_jsx(PublicRoute,{children:/*#__PURE__*/_jsx(LoginForm,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/register\",element:/*#__PURE__*/_jsx(PublicRoute,{children:/*#__PURE__*/_jsx(RegisterForm,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(DashboardRedirect,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/user-dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(UserDashboard,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/file-dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(UserFileDashboard,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/admin-dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{adminOnly:true,children:/*#__PURE__*/_jsx(AdminDashboard,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/document/:id\",element:/*#__PURE__*/_jsx(ProtectedRoute,{children:/*#__PURE__*/_jsx(DocumentViewer,{})})}),/*#__PURE__*/_jsx(Route,{path:\"*\",element:/*#__PURE__*/_jsx(Navigate,{to:isAuthenticated?\"/dashboard\":\"/\"})})]})})]});}function App(){return/*#__PURE__*/_jsx(AuthProvider,{children:/*#__PURE__*/_jsx(Router,{children:/*#__PURE__*/_jsx(AppContent,{})})});}export default App;","map":{"version":3,"names":["React","BrowserRouter","Router","Routes","Route","Navigate","AuthProvider","useAuth","Navbar","Home","UserDashboard","AdminDashboard","LoginForm","RegisterForm","DocumentViewer","UserFileDashboard","jsx","_jsx","jsxs","_jsxs","ProtectedRoute","_ref","_user$role","children","adminOnly","isAuthenticated","user","loading","className","to","normalizedRole","role","toUpperCase","includes","PublicRoute","_ref2","DashboardRedirect","replace","console","log","roles","Array","isArray","map","r","isAdmin","some","AppContent","path","element","App"],"sources":["c:/Users/yuvasri/OneDrive/Desktop/Digital lock product/reactapp/src/App.js"],"sourcesContent":["import React from \"react\";\nimport {\n  BrowserRouter as Router,\n  Routes,\n  Route,\n  Navigate,\n} from \"react-router-dom\";\n\nimport { AuthProvider, useAuth } from \"./contexts/AuthContext\";\nimport Navbar from \"./components/Navbar\";\nimport Home from \"./components/Home\";\nimport UserDashboard from \"./components/UserDashboard\";\nimport AdminDashboard from \"./components/AdminDashboard\";\nimport LoginForm from \"./components/LoginForm\";\nimport RegisterForm from \"./components/RegisterForm\";\nimport DocumentViewer from \"./components/DocumentViewer\";\nimport UserFileDashboard from \"./components/UserFileDashboard\";\n\n// Protected Route Component\nconst ProtectedRoute = ({ children, adminOnly = false }) => {\n  const { isAuthenticated, user, loading } = useAuth();\n  \n  if (loading) {\n    return <div className=\"flex justify-center items-center min-h-screen\">Loading...</div>;\n  }\n  \n  if (!isAuthenticated) {\n    return <Navigate to=\"/login\" />;\n  }\n  \n  // Normalize the role to handle ROLE_ADMIN, Admin, etc.\n  const normalizedRole = user?.role?.toUpperCase() || \"\";\n\n  if (adminOnly && !normalizedRole.includes(\"ADMIN\")) {\n    return <Navigate to=\"/dashboard\" />;\n  }\n  \n  return children;\n};\n\n// Public Route Component (redirect if already logged in)\nconst PublicRoute = ({ children }) => {\n  const { isAuthenticated, loading } = useAuth();\n  \n  if (loading) {\n    return <div className=\"flex justify-center items-center min-h-screen\">Loading...</div>;\n  }\n  \n  if (isAuthenticated) {\n    return <Navigate to=\"/dashboard\" />;\n  }\n  \n  return children;\n};\n\n// Dashboard Redirect Component\nconst DashboardRedirect = () => {\n  const { user, loading } = useAuth();\n  \n  if (loading) {\n    return <div className=\"flex justify-center items-center min-h-screen\">Loading...</div>;\n  }\n\n  if (!user) {\n    return <Navigate to=\"/login\" replace />;\n  }\n\n  // Debug logging\n  console.log('üîç DashboardRedirect - Full user object:', user);\n  console.log('üîç DashboardRedirect - user.role:', user.role);\n  console.log('üîç DashboardRedirect - user.roles:', user.roles);\n\n  // Handle both cases:\n  // Case 1: user.role = \"ROLE_ADMIN\" or \"ADMIN\"\n  // Case 2: user.roles = [\"ROLE_ADMIN\", \"ROLE_USER\"]\n  let roles = [];\n\n  if (Array.isArray(user.roles)) {\n    roles = user.roles.map(r => r.toUpperCase());\n  } else if (user.role) {\n    roles = [user.role.toUpperCase()];\n  }\n\n  console.log('üîç DashboardRedirect - processed roles:', roles);\n\n  // Check if user has ADMIN in any of their roles\n  const isAdmin = roles.some(r => r.includes(\"ADMIN\"));\n  \n  console.log('üîç DashboardRedirect - isAdmin:', isAdmin);\n\n  if (isAdmin) {\n    console.log('‚úÖ Redirecting to admin dashboard');\n    return <Navigate to=\"/admin-dashboard\" replace />;\n  } else {\n    console.log('‚úÖ Redirecting to file dashboard');\n    return <Navigate to=\"/file-dashboard\" replace />;\n  }\n};\n\n\nfunction AppContent() {\n  const { isAuthenticated } = useAuth();\n  \n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      <Navbar />\n      <main className=\"p-6 mt-20\">\n        <Routes>\n          <Route path=\"/\" element={<Home />} />\n          <Route path=\"/login\" element={\n            <PublicRoute>\n              <LoginForm />\n            </PublicRoute>\n          } />\n          <Route path=\"/register\" element={\n            <PublicRoute>\n              <RegisterForm />\n            </PublicRoute>\n          } />\n          <Route path=\"/dashboard\" element={\n            <ProtectedRoute>\n              {/* Redirect admin users to admin dashboard */}\n              <DashboardRedirect />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/user-dashboard\" element={\n            <ProtectedRoute>\n              <UserDashboard />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/file-dashboard\" element={\n            <ProtectedRoute>\n              <UserFileDashboard />\n            </ProtectedRoute>\n          } />\n          <Route path=\"/admin-dashboard\" element={\n            <ProtectedRoute adminOnly={true}>\n              <AdminDashboard />\n            </ProtectedRoute>\n          } />\n\n          <Route path=\"/document/:id\" element={\n            <ProtectedRoute>\n              <DocumentViewer />\n            </ProtectedRoute>\n          } />\n          <Route path=\"*\" element={<Navigate to={isAuthenticated ? \"/dashboard\" : \"/\"} />} />\n        </Routes>\n      </main>\n    </div>\n  );\n}\n\nfunction App() {\n  return (\n    <AuthProvider>\n      <Router>\n        <AppContent />\n      </Router>\n    </AuthProvider>\n  );\n}\n\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}